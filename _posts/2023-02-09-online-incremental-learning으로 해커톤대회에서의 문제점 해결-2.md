---
title : online-incremental-learning으로 해커톤대회에서의 문제점 해결-2
date : 2023-02-09 09:42:00 +09:00
categories : [머신러닝, 파이썬]
tags : [online learning, incremental learning, **continual learning**, lifelong learning] 
---


# 발상은 좋으나...
---

모델을 지속적으로 학습시키고, 다양한 Task를 감당하게 만든다는 것은 굉장히 좋은 아이디어다.

하지만

- 결국 근본적인 한계점은 비용에 있다

- 현재의 전이학습을 지원하는 모델들에서는   Task의 손실없는 변경은 힘들지만 Class 추가 정도는 대응 가능하다.



## YOLO v5에서 마주한 문제점들
---
- YOLO v5에서 Class를 추가해가며 다양한 데이터셋을 연속적으로 학습시켰다

- 정확도가 생각보다 잘 나오지 않았는데, 이유에 대해서 간단히 생각해보았다.


![나의 단짝친구 찾기 "강아지 성격"](https://interbalance.org/wp-content/uploads/2021/08/flouffy-VBkIK3qj3QE-unsplash-scaled-e1631077364762.jpg)

> 이런 강아지 사진으로 학습

강아지 사진을 통해서 강아지 객체를 탐지하도록 모델을 학습시켰다고 가정한다

이후

![고양이의 행동을 다 이해하려 하지 마세요” [반려인의 오후] - 시사IN](https://www.sisain.co.kr/news/photo/202109/45623_82189_2148.jpg)

> 고양이 사진

고양이 사진을 통해서 추가된 Class인 고양이를 학습시켰다.

이제 여기서 문제가 발생한다.

![개귀엽냥? '불청개'를 맞은 고양이 - 더퍼스트미디어](https://www.thefirstmedia.net/news/photo/201802/40256_21514_4758.jpg)

> 강아지와 고양이가 같이 있는 사진


바로 이런 강아지와 고양이가 겹치는 경우다.

일반적으로 데이터셋을 완벽하게 분리하여 고양이 Label에 해당하는 이미지에 단 하나의 오차도 없이 강아지가 없다면 상관 없을지도 모른다.

하지만, 특정 문제들은 Label이 정확하지 않고, 이를 비유하자면 강아지와 고양이가 같이 있어도 강아지에만, 혹은 고양이에만 Mask 작업을 해놓고 Label을 해놓은 데이터가 많다는 것이다.

결국 Class의 추가에 대한 학습이 방해되는 요인으로 작용하는건

- 추가 학습 데이터셋에 존재하는 기존의 Class에 해당하는 객체들

- 그러나 기존 Class에 해당하는 객체들에는 Label 작업이 되어있지 않음



이 정도로 파악했다.


## 해결방안

---

물론 실험을 통해 정해진 환경에서 기록해야 겠지만, 그냥 아이디어만 제시해본다면

추가될 데이터셋 전체를 현재 모델이 Predict하여 기존의 Label에 모델 Predict Label을 추가한 새로운 데이터셋을 만든다

이를 모델에 추가 데이터셋으로 학습시키는 것이다.

![Incremental문제점대응방안](https://user-images.githubusercontent.com/50907018/217688895-56a4db3f-5133-44c0-bc7f-fd9b3f24ed7b.png)

> 간단한 개요도

- 실험을 통해 정확도의 유의미한 변화가 있는지 확인해봐야 한다



## 필요성?

---

- 하나의 Task라도 제대로 하는 모델도 만들기 힘든데... 무슨 여러 Task를?

ML 분야가 나아갈 방향인건 사실이나, 아직까지는 수 많은 현실에 존재하는 Task들을 다양한 모델들이 제대로 처리 못하는 경우도 많다.

결국 Lifelong 에 대한 개념은 굉장한 비용이 들어간 모델에 대해서 사용해야 할 것 같다




